# 2026-02-02 Sticky Note Sync Fix

## 背景
- 通过贴纸窗口内的按钮操作其他贴纸时，之前已经取消钉住的贴纸会再次出现。
- 原因：NotesService 在多窗口下使用共享内存缓存，贴纸窗口执行任意写操作（完成/置顶等）前未从磁盘刷新，会把旧的 `isPinned` 状态重新写回磁盘。

## 处理
- 作为兼容/降级策略：所有写操作执行前统一 `loadNotes` 以同步最新磁盘状态，避免写回过期数据。
- 根因级修复见：`docs/2026-02-02-single-writer-notes.md`（panel 进程单写入者，其他进程不直接写盘）。

## 验证
- 步骤：
  1. 在主面板取消钉住某贴纸，确认窗口关闭。
  2. 打开另一张贴纸窗口，点击“完成/置顶”等任意按钮。
  3. 观察被取消钉住的贴纸不再复活；重启应用后依然保持未钉住。

## 影响
- 频繁写操作会多一次磁盘读取，但规模小（本地 JSON），实测无明显延迟。
